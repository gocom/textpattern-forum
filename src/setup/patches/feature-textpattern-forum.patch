diff --git a/include/email.php b/include/email.php
index 88c62a8..e4dc5d1 100644
--- a/include/email.php
+++ b/include/email.php
@@ -60,149 +60,7 @@ function encode_mail_text($str)
 //
 function bbcode2email($text, $wrap_length = 72)
 {
-	static $base_url;
-
-	if (!isset($base_url))
-		$base_url = get_base_url();
-
-	$text = pun_trim($text, "\t\n ");
-
-	$shortcut_urls = array(
-		'topic' => '/viewtopic.php?id=$1',
-		'post' => '/viewtopic.php?pid=$1#p$1',
-		'forum' => '/viewforum.php?id=$1',
-		'user' => '/profile.php?id=$1',
-	);
-
-	// Split code blocks and text so BBcode in codeblocks won't be touched
-	list($code, $text) = extract_blocks($text, '[code]', '[/code]');
-
-	// Strip all bbcodes, except the quote, url, img, email, code and list items bbcodes
-	$text = preg_replace(array(
-		'%\[/?(?!(?:quote|url|topic|post|user|forum|img|email|code|list|\*))[a-z]+(?:=[^\]]+)?\]%i',
-		'%\n\[/?list(?:=[^\]]+)?\]%i' // A separate regex for the list tags to get rid of some whitespace
-	), '', $text);
-
-	// Match the deepest nested bbcode
-	// An adapted example from Mastering Regular Expressions
-	$match_quote_regex = '%
-		\[(quote|\*|url|img|email|topic|post|user|forum)(?:=([^\]]+))?\]
-		(
-			(?>[^\[]*)
-			(?>
-				(?!\[/?\1(?:=[^\]]+)?\])
-				\[
-				[^\[]*
-			)*
-		)
-		\[/\1\]
-	%ix';
-
-	$url_index = 1;
-	$url_stack = array();
-	while (preg_match($match_quote_regex, $text, $matches))
-	{
-		// Quotes
-		if ($matches[1] == 'quote')
-		{
-			// Put '>' or '> ' at the start of a line
-			$replacement = preg_replace(
-				array('%^(?=\>)%m', '%^(?!\>)%m'),
-				array('>', '> '),
-				$matches[2]." said:\n".$matches[3]);
-		}
-
-		// List items
-		elseif ($matches[1] == '*')
-		{
-			$replacement = ' * '.$matches[3];
-		}
-
-		// URLs and emails
-		elseif (in_array($matches[1], array('url', 'email')))
-		{
-			if (!empty($matches[2]))
-			{
-				$replacement = '['.$matches[3].']['.$url_index.']';
-				$url_stack[$url_index] = $matches[2];
-				$url_index++;
-			}
-			else
-				$replacement = '['.$matches[3].']';
-		}
-
-		// Images
-		elseif ($matches[1] == 'img')
-		{
-			if (!empty($matches[2]))
-				$replacement = '['.$matches[2].']['.$url_index.']';
-			else
-				$replacement = '['.basename($matches[3]).']['.$url_index.']';
-
-			$url_stack[$url_index] = $matches[3];
-			$url_index++;
-		}
-
-		// Topic, post, forum and user URLs
-		elseif (in_array($matches[1], array('topic', 'post', 'forum', 'user')))
-		{
-			$url = isset($shortcut_urls[$matches[1]]) ? $base_url.$shortcut_urls[$matches[1]] : '';
-
-			if (!empty($matches[2]))
-			{
-				$replacement = '['.$matches[3].']['.$url_index.']';
-				$url_stack[$url_index] = str_replace('$1', $matches[2], $url);
-				$url_index++;
-			}
-			else
-				$replacement = '['.str_replace('$1', $matches[3], $url).']';
-		}
-
-		// Update the main text if there is a replacement
-		if (!is_null($replacement))
-		{
-			$text = str_replace($matches[0], $replacement, $text);
-			$replacement = null;
-		}
-	}
-
-	// Put code blocks and text together
-	if (isset($code))
-	{
-		$parts = explode("\1", $text);
-		$text = '';
-		foreach ($parts as $i => $part)
-		{
-			$text .= $part;
-			if (isset($code[$i]))
-				$text .= trim($code[$i], "\n\r");
-		}
-	}
-
-	// Put URLs at the bottom
-	if ($url_stack)
-	{
-		$text .= "\n\n";
-		foreach ($url_stack as $i => $url)
-			$text .= "\n".' ['.$i.']: '.$url;
-	}
-
-	// Wrap lines if $wrap_length is higher than -1
-	if ($wrap_length > -1)
-	{
-		// Split all lines and wrap them individually
-		$parts = explode("\n", $text);
-		foreach ($parts as $k => $part)
-		{
-			preg_match('%^(>+ )?(.*)%', $part, $matches);
-			$parts[$k] = wordwrap($matches[1].$matches[2], $wrap_length -
-				strlen($matches[1]), "\n".$matches[1]);
-		}
-
-		return implode("\n", $parts);
-	}
-	else
-		return $text;
+	return wordwrap($text, 72);
 }


diff --git a/include/parser.php b/include/parser.php
index 5d564d2..fde6e8b 100644
--- a/include/parser.php
+++ b/include/parser.php
@@ -64,6 +64,7 @@ $smilies = array(
 //
 function preparse_bbcode($text, &$errors, $is_signature = false)
 {
+	return $text;
 	global $pun_config, $lang_common, $lang_post, $re_list;

 	// Remove empty tags
@@ -889,46 +890,25 @@ function do_smilies($text)
 //
 function parse_message($text, $hide_smilies)
 {
-	global $pun_config, $lang_common, $pun_user;
+	global $pun_config, $cur_post;
+	static $textile = null;

 	if ($pun_config['o_censoring'] == '1')
+	{
 		$text = censor_words($text);
+	}

-	// Convert applicable characters to HTML entities
-	$text = pun_htmlspecialchars($text);
-
-	// If the message contains a code tag we have to split it up (text within [code][/code] shouldn't be touched)
-	if (strpos($text, '[code]') !== false && strpos($text, '[/code]') !== false)
-		list($inside, $text) = extract_blocks($text, '[code]', '[/code]');
-
-	if ($pun_config['p_message_bbcode'] == '1' && strpos($text, '[') !== false && strpos($text, ']') !== false)
-		$text = do_bbcode($text);
-
-	if ($pun_config['o_smilies'] == '1' && $pun_user['show_smilies'] == '1' && $hide_smilies == '0')
-		$text = do_smilies($text);
-
-	// Deal with newlines, tabs and multiple spaces
-	$pattern = array("\n", "\t", '  ', '  ');
-	$replace = array('<br />', '&#160; &#160; ', '&#160; ', ' &#160;');
-	$text = str_replace($pattern, $replace, $text);
+	if ($textile === null)
+    {
+		$textile = new Textpattern\Fluxbb\Textile\Parser();
+    }

-	// If we split up the message before we have to concatenate it together again (code tags)
-	if (isset($inside))
+	if (defined('PUN_NEW_MEMBER') && $cur_post['group_id'] == PUN_NEW_MEMBER)
 	{
-		$parts = explode("\1", $text);
-		$text = '';
-		foreach ($parts as $i => $part)
-		{
-			$text .= $part;
-			if (isset($inside[$i]))
-			{
-				$num_lines = (substr_count($inside[$i], "\n"));
-				$text .= '</p><div class="codebox"><pre'.(($num_lines > 28) ? ' class="vscroll"' : '').'><code>'.pun_trim($inside[$i], "\n\r").'</code></pre></div><p>';
-			}
-		}
+		return $textile->textileRestricted($text, false, true);
 	}

-	return clean_paragraphs($text);
+	return $textile->textileRestricted($text, false, false);
 }


@@ -963,25 +943,23 @@ function clean_paragraphs($text)
 //
 function parse_signature($text)
 {
-	global $pun_config, $lang_common, $pun_user;
+	global $pun_config, $cur_post;
+	static $textile = null;

 	if ($pun_config['o_censoring'] == '1')
+	{
 		$text = censor_words($text);
+	}

-	// Convert applicable characters to HTML entities
-	$text = pun_htmlspecialchars($text);
-
-	if ($pun_config['p_sig_bbcode'] == '1' && strpos($text, '[') !== false && strpos($text, ']') !== false)
-		$text = do_bbcode($text, true);
-
-	if ($pun_config['o_smilies_sig'] == '1' && $pun_user['show_smilies'] == '1')
-		$text = do_smilies($text);
-
+	if ($textile === null)
+	{
+		$textile = new Textpattern\Fluxbb\Textile\Parser();
+	}

-	// Deal with newlines, tabs and multiple spaces
-	$pattern = array("\n", "\t", '  ', '  ');
-	$replace = array('<br />', '&#160; &#160; ', '&#160; ', ' &#160;');
-	$text = str_replace($pattern, $replace, $text);
+	if (defined('PUN_NEW_MEMBER') && $cur_post['group_id'] == PUN_NEW_MEMBER)
+	{
+		return $textile->textileRestricted($text, false, true);
+	}

-	return clean_paragraphs($text);
+	return $textile->textileRestricted($text, false, false);
 }
diff --git a/lang/English/profile.php b/lang/English/profile.php
index c9e63c2..4b54b4f 100644
--- a/lang/English/profile.php
+++ b/lang/English/profile.php
@@ -95,7 +95,7 @@ $lang_profile = array(
 'Avatar info'					=>	'An avatar is a small image that will be displayed with all your posts. You can upload an avatar by clicking the link below.',
 'Change avatar'					=>	'Change avatar',
 'Signature legend'				=>	'Compose your signature',
-'Signature info'				=>	'A signature is a small piece of text that is attached to your posts. In it, you can enter just about anything you like. Perhaps you would like to enter your favourite quote or your star sign. It\'s up to you! In your signature you can use BBCode if it is allowed in this particular forum. You can see the features that are allowed/enabled listed below whenever you edit your signature.',
+'Signature info'				=>	'A signature is a small piece of text that is attached to your posts. In it, you can enter just about anything you like. Perhaps you would like to enter your favourite quote or your star sign. It\'s up to you!',
 'Sig preview'					=>	'Current signature preview:',
 'No sig'						=>	'No signature currently stored in profile.',
 'Signature quote/code/list/h'	=>	'The quote, code, list, and heading BBCodes are not allowed in signatures.',


diff --git a/index.php b/index.php
index 888cc91..12d5972 100644
--- a/index.php
+++ b/index.php
@@ -62,6 +62,8 @@ $forum_actions = array();
 if (!$pun_user['is_guest'])
 	$forum_actions[] = '<a href="misc.php?action=markread&amp;csrf_token='.pun_csrf_token().'">'.$lang_common['Mark all as read'].'</a>';

+$description = pun_htmlspecialchars($pun_config['o_board_desc']);
+$page_head['meta_desc'] = '<meta name="description" content="'.$description.'" />';
 $page_title = array(pun_htmlspecialchars($pun_config['o_board_title']));
 define('PUN_ALLOW_INDEX', 1);
 define('PUN_ACTIVE_PAGE', 'index');
